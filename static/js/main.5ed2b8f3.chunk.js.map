{"version":3,"sources":["components/ChatInput.js","components/ChatMessage.js","components/ChatMessageList.js","components/utils/LogOutButton.js","redux/actions.js","components/Chat.js","components/Header.js","components/App.js","serviceWorker.js","redux/reducers.js","index.js"],"names":["ChatInput","state","message","action","onSubmit","e","preventDefault","props","onSubmitMessage","setState","type","placeholder","value","this","onChange","target","variant","Component","ChatMessage","name","time","className","Date","toLocaleString","ChatMessageList","console","log","scrollToBottom","messagesEnd","scrollIntoView","behavior","messages","map","key","uniqid","from","style","float","clear","ref","el","connect","LogOutButton","logOut","onClick","ADD_MESSAGES","Chat","addMessages","dispatch","submitMessage","messageString","ws","send","JSON","stringify","localStorage","removeItem","initConnection","WebSocket","onopen","getItem","onmessage","event","parse","data","onclose","onerror","error","alert","htmlFor","id","setItem","Header","bg","Brand","href","alt","src","width","height","App","notifyMe","window","Notification","permission","requestPermission","then","Boolean","location","hostname","match","initialState","store","createStore","Object","assign","concat","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5ed2b8f3.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from 'react-bootstrap/Button';\r\n\r\nclass ChatInput extends Component {\r\n  static propTypes = {\r\n    onSubmitMessage: PropTypes.func.isRequired,\r\n  }\r\n  state = {\r\n    message: '',\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <form\r\n        action=\".\"\r\n        onSubmit={e => {\r\n          e.preventDefault()\r\n          this.props.onSubmitMessage(this.state.message)\r\n          this.setState({ message: '' })\r\n        }}\r\n      >\r\n        <input\r\n          type=\"text\"\r\n          placeholder={'Enter message...'}\r\n          value={this.state.message}\r\n          onChange={e => this.setState({ message: e.target.value })}\r\n        />\r\n         <Button type=\"submit\" variant=\"dark\">Send</Button>\r\n        {/* <input type=\"submit\" value={'Send'} /> */}\r\n      </form>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ChatInput;","import React from 'react';\n\nconst ChatMessage = ({ name, message, time }) =>\n<div className=\"message\">\n  <strong className=\"nickname\">{name}</strong><span className='time'>{new Date(time).toLocaleString()}</span>\n  <em className='message-text'>{message}</em>  \n</div> \n\nexport default ChatMessage;\n  ","import React, { Component } from 'react';\nimport ChatMessage from './ChatMessage';\nimport uniqid from 'uniqid';\nimport { connect } from 'react-redux';\n\nclass ChatMessageList extends Component {\n    constructor(props) {\n        super();\n        console.log(props)\n      }\n\n      componentDidMount() {\n        this.scrollToBottom();\n      }\n    \n      componentDidUpdate() {\n        this.scrollToBottom();\n      }\n    \n      scrollToBottom() {\n        this.messagesEnd.scrollIntoView({ behavior: 'smooth' });\n      }\n\n  render() {\n    return (\n      <section className=\"messages-block\">\n        {this.props.messages.map(message =>\n          <ChatMessage\n            key={uniqid()}\n            message={message.message}\n            name={message.from}\n            time={message.time}\n          />,\n        )}\n        <div style={{ float:\"left\", clear: \"both\" }}\n             ref={(el) => { this.messagesEnd = el; }}>\n        </div>  \n      </section>\n    );\n  }\n}\n\nexport default connect((state) => ({messages: state.messages}))(ChatMessageList);\n","import React from 'react';\r\nimport Button from 'react-bootstrap/Button';\r\n\r\nconst LogOutButton = ({logOut}) => (\r\n  <Button onClick={logOut} variant=\"dark\">Log out</Button>\r\n)\r\n\r\nexport default LogOutButton;","/*\n * action types\n */\n\nexport const ADD_MESSAGES = 'ADD_MESSAGES'\n\n\n/*\n * action creators\n */\nexport default function addMessages(messages) {\n  return { type: ADD_MESSAGES, messages }\n}\n","import React, { Component } from 'react';\nimport ChatInput from './ChatInput';\nimport ChatMessageList from './ChatMessageList';\nimport LogOutButton from './utils/LogOutButton';\nimport { connect } from 'react-redux';\nimport addMessages from '../redux/actions'\n\nconst URL = 'ws://st-chat.shas.tel';\n\nclass Chat extends Component {\n  constructor(props) {\n    super();\n    this.state = {\n      name: '',\n      messages: [],     \n    };\n  } \n  \n  componentDidMount() {\n    this.initConnection();\n  }\n\n  initConnection() {\n    this.ws = new WebSocket(URL);\n    this.ws.onopen = () => {\n      console.log('connected'); \n      this.setState(state => ({ name: localStorage.getItem('nickname') }))         \n    }\n\n    this.ws.onmessage = event => {\n      const message = JSON.parse(event.data);\n      this.addMessages(message);\n    }\n\n    this.ws.onclose = (event) => {\n      console.log('disconnected')\n      // automatically try to reconnect on connection loss\n      this.initConnection();      \n    }\n\n    this.ws.onerror = function(error) {\n      alert(\"Ошибка \" + error.message);\n    };\n  }\n\n  addMessages = messages => {\n    const { dispatch } = this.props;\n    dispatch(addMessages(messages))\n  }\n\n  submitMessage = messageString => {\n    // on submitting the ChatInput form, send the message, add it to the list and reset the input\n    const message = { from: this.state.name, message: messageString };\n    this.ws.send(JSON.stringify(message));\n  }\n\n  logOut = () => {\n          localStorage.removeItem('nickname');\n          this.setState(state => ({ name: '' }));\n           }\n\n  render() {\n    return (\n      <main className=\"main\">\n        \n        <label htmlFor=\"name\">\n          Nickname:&nbsp;\n          <input\n            type=\"text\"\n            id={'name'}\n            placeholder={'Enter your name...'}\n            value={this.state.name}\n            onChange={e => {\n                        localStorage.setItem('nickname', e.target.value)\n                        this.setState({ name: e.target.value });\n                      }}\n                            \n          />\n        </label>\n        <LogOutButton logOut={this.logOut} />\n        <ChatMessageList/>\n        <ChatInput\n          ws={this.ws}\n          onSubmitMessage={messageString => this.submitMessage(messageString)}\n        />\n      </main>\n    )\n  }\n}\n\nexport default connect()(Chat);\n","import React, { Component } from 'react';\r\n// import Nav from 'react-bootstrap/Nav';\r\nimport Navbar from 'react-bootstrap/Navbar';\r\n\r\n\r\nclass Header extends Component {\r\n  render() {\r\n    return (\r\n      <> \r\n        <header>\r\n          <Navbar bg=\"dark\" variant=\"dark\">\r\n            <Navbar.Brand href=\"#home\" className='chat-title'>\r\n              <img\r\n                alt=\"\"\r\n                src=\"../images/logo.png\"\r\n                width=\"50\"\r\n                height=\"50\"\r\n                className=\"d-inline-block align-top\"\r\n              />\r\n              {' My super chat'}\r\n            </Navbar.Brand>          \r\n          </Navbar>\r\n        </header>         \r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Header;","import React, { Component } from 'react';\n\nimport '../App.css';\nimport Chat from './Chat';\nimport Header from './Header';\n//import Notifications from './utils/Notifications';\n\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <Header />\n        <button onClick={this.notifyMe}>Notify me!</button>\n        <Chat />\n        {/* <Notifications /> */}\n      </div>\n    )\n  }\n\n  notifyMe() {\n    // Let's check if the browser supports notifications\n    if (!(\"Notification\" in window)) {\n      alert(\"This browser does not support desktop notification\");\n    }\n  \n    // Let's check whether notification permissions have already been granted\n    else if (Notification.permission === \"granted\") {\n      // If it's okay let's create a notification\n      var notification = new Notification(\"Hi there!\");\n    }\n  \n    // Otherwise, we need to ask the user for permission\n    else if (Notification.permission !== \"denied\") {\n      Notification.requestPermission().then(function (permission) {\n        // If the user accepts, let's create a notification\n        if (permission === \"granted\") {\n          var notification = new Notification(\"Hi there!\");\n        }\n      });\n    }\n  \n    // At last, if the user has denied notifications, and you \n    // want to be respectful there is no need to bother them any more.\n  }\n}\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if ('serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      \n      const swFileName = process.env.NODE_ENV === 'production'  ? 'service-worker.js'  : 'custom-sw.js'\n      const swUrl = `${process.env.PUBLIC_URL}/${swFileName}`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import {\n    ADD_MESSAGES,\n} from './actions'\n\nconst initialState = {\n    messages: []\n  }\n\nexport default function chatApp(state = initialState, action) {\n    switch (action.type) {\n        case ADD_MESSAGES:\n            return Object.assign({}, state, {\n                messages: state.messages.concat(action.messages)\n            })\n        default:\n            return state\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { createStore } from 'redux'\nimport { Provider } from 'react-redux'\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\nimport chatApp from './redux/reducers'\nconst store = createStore(chatApp)\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n   document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}